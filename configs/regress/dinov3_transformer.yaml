seed: &seed 42
tasks:
  - livelier
  - more beautiful
  - more depressing
  - more boring
  - safer
  - wealthier
processor:
  _target_: transformers.AutoImageProcessor.from_pretrained
  pretrained_model_name_or_path: &pretrained_model_name_or_path facebook/dinov3-vitb16-pretrain-lvd1689m
  do_resize: false
backbone:
  _target_: transformers.AutoModel.from_pretrained
  pretrained_model_name_or_path: *pretrained_model_name_or_path
model_partial:
  _target_: grins.modeling.regress.dinov3.DINOv3Transformer
  _partial_: true
  num_transformer_layers: 2
  activation: GELU
  freeze_backbone: true

datasets:
  data_dir: &data_dir data/external/mit-place-pulse
  transform:
      _target_: torchvision.transforms.Compose
      transforms:
        - _target_: torchvision.transforms.PILToTensor
        - _target_: grins.data.mit_place_pulse.preprocess.RemoveWatermark
          height: 277
  train_partial:
    _target_: grins.data.mit_place_pulse.dataset.MITPlacePulseDataset
    _partial_: true
    data_dir: *data_dir
    question: null
    seed: *seed
    split: train
  val_partial:
    _target_: grins.data.mit_place_pulse.dataset.MITPlacePulseDataset
    _partial_: true
    data_dir: *data_dir
    seed: *seed
    split: val
dataloaders:
  train_partial:
    _target_: torch.utils.data.DataLoader
    _partial_: true
    batch_size: 256
    shuffle: true
    num_workers: 8
  val_partial:
    _target_: torch.utils.data.DataLoader
    _partial_: true
    batch_size: 256
    shuffle: true
    num_workers: 8

loss_function_partial:
  _target_: grins.modeling.regress.TaskWeightedPairwiseLogisticRankingLoss
  _partial_: true
  use_task_weighting: false
optimizer_partial:
  _target_: torch.optim.AdamW
  _partial_: True
  lr: 0.00005
scheduler_name: constant_with_warmup

project_dir: out/regress/dinov3_transformer
accelerator_partial:
  _target_: accelerate.Accelerator
  _partial_: true
  log_with: wandb
init_trackers_params:
  project_name: GRINS
num_epochs: 10
warmup_ratio: 0.2
